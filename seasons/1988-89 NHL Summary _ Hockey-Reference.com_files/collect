/* Copyright (c) 2018 Deduce */
(function(){var ver="C";var xid="w2t3dpxrb2jix6p67w47bhkus4zsac";var env="dev";var ip="10.128.23.208";var $T=new Date();var url= "";url+="/private/ping";var hsk=['ehls1','ehus1','ehlm5','ehum5','ehls2','ehus2'];var hlen=[40,40,32,32,64,64];var xs='localStorage';var k='_dd_pktn_i';function logger(msg){if(env=="dev")console.log(msg);};function puberror(msg){console.log("error: "+msg);console.error("error: "+msg);if(Math.random()<0.0001)$0(url+"_error?"+msg);$0("//deduce.error/"+msg);};function euc(x){return encodeURIComponent(x);};function aa(name,val,days){var exp;if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));exp="; expires="+date.toGMTString();} else exp="";document.cookie=name+"="+val+exp+"; path=/";};function ab(name){var nameeq=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameeq)==0)return c.substring(nameeq.length,c.length);};return null;};function ac(name,val){if(!(xs in window))return;window[xs].setItem(name,val);};function ad(name){if(!(xs in window))return;return window[xs].getItem(name);};function $$(name,val,exp){aa(name,val,exp);ac(name,val);};function $1(name){return ad(name)|| ab(name);};function P(k,v){if(!v)return "";return ";"+k+"="+euc(v);};function $0(url,ps){if(ps)url+="?"+ps;logger(url);var n=document.createElement('iframe');n.frameborder=0;n.height=0;n.width=0;n.src=url;var head=document.getElementsByTagName('head');var node=(head.length<1)?document.body:head[0];node.appendChild(n);};if(typeof dd_info==="undefined")return puberror("dd_info is not defined");if(!('site' in dd_info))return puberror("dd_info missing site");var nh=0;var ph,i,ch,chx,hl;for(i=0;i<6;i+=2){ch=hsk[i];chx=hsk[i+1];if(!dd_info[ch]||!dd_info[chx])continue;if(dd_info[ch].toLowerCase()==dd_info[chx].toLowerCase())return puberror("invalid hashing: "+ch+"/"+chx+";site="+dd_info.site);};for(i=0;i<6;i++){ch=hsk[i];hl=hlen[i];if(!dd_info[ch])continue;if(dd_info[ch].length!=hl)return puberror("invalid hashing: "+ch+";site="+dd_info.site);nh++;if(!ph)ph=dd_info[ch];};var info=$1(k);var a,lt,lx,lh,li,ls,ft;if(info){logger(">"+info);a=info.split("/");if(a[0]==ver){lt=a[1];ft=a[2];lx=a[3];lh=a[4];ls=a[5];li=a[6];logger("info: "+lt+"; "+li+"; "+lh);if(lx)xid=lx;};};var n=Math.floor($T.getTime()/1000);function want(){if(env=="dev")return 1;if(Math.random()<0.0001)return 1;if(!lh &&!ph)return;if(n-lt<3600)return;if(n-lt<14*24*3600)return 1;if((new Date(lt*1000)).getMonth!=$T.getMonth())return 1;if(lh!=ph)return 1;if(ls!=dd_info.site)return 1;if(li!=ip)return 1;return;};if(!want())return;var ps="site="+euc(dd_info.site);ps+=P("ehls1",dd_info.ehls1);ps+=P("ehus1",dd_info.ehus1);ps+=P("ehlm5",dd_info.ehlm5);ps+=P("ehum5",dd_info.ehum5);ps+=P("ehls2",dd_info.ehls2);ps+=P("ehus2",dd_info.ehus2);ps+=P("testmode",dd_info.testmode);ps+=P("xyzzy",dd_info.xyzzy);ps+=P("vers",dd_info.vers);ps+=P("xid",xid);ps+=P("lt",lt);ps+=P("ft",ft);ps+=P("ct",$T.getTime());if(!ft)ft=n;$$(k,[ver,n,ft,xid,dd_info.ehls1,dd_info.site,ip].join("/"));$0(url,ps);})();